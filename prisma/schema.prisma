generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id              Int      @id @default(autoincrement())
  uuid            String   @unique @default(uuid())
  name            String?
  email           String   @unique
  password        String
  roleId          Int
  isActive        Boolean  @default(true)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  accessCode      String?
  status          String   @default("ACTIVE")
  
  employeeId      String?  @unique
  jobTitle        String?
  department      String?
  lastLoginDate   DateTime? 

  approvals       Approval[]
  auditLogs       AuditLog[]      @relation("UserAuditLogs")
  documents       Document[]      @relation("uploadedBy")
  evaluations     Evaluation[]    @relation("UserEvaluations")
  ipcs            IPC[]           @relation("UserIPCs")
  notifications   Notification[]  @relation("UserNotifications")
  rfqs            RFQ[]           @relation("UserRFQs")
  role            Role     @relation(fields: [roleId], references: [id])

  vendor          Vendor?

  vendorsAssigned Vendor[] @relation("AssignedReviewer")
  vendorsReviewed Vendor[] @relation("LastReviewedBy")

  // ---Reporting System Relations---
  reportsCreated  Report[]                @relation("UserCreatedReports")
  reportExecutions ReportExecution[]      @relation("UserReportExecutions")
  reportFavorites UserReportFavorite[]    @relation("UserReportFavorites")

  // ðŸ‘‡ ADDED: MISSING RELATIONS FOR THE TASK MODEL
  tasksAssigned   Task[] @relation("AssignedTasks") // Inverse for 'assignedUser'
  tasksCreated    Task[] @relation("CreatedTasks")  // Inverse for 'assignedByUser'

     // ðŸ‘‡ ADD: New relations for document management
  signedDocuments Document[] @relation("SignedDocuments")
  documentApprovals DocumentApproval[] @relation("DocumentApprovalApprover")
  createdTemplates DocumentTemplate[] @relation("DocumentTemplateCreator")
  approvalActions ApprovalAction[] @relation("ApprovalActionApprover") // ðŸ‘ˆ ADD THIS
}

model Role {
  id    Int     @id @default(autoincrement())
  desc  String?
  name  String  @unique
  users User[]

  // Add these relations:
  documentApprovalSteps DocumentApprovalStep[]
  approvalWorkflowSteps ApprovalWorkflowStep[] // ðŸ‘ˆ ADD THIS
}

// --- Vendor Status Enum (Already good, but adding a status for 'Needs Renewal') ---
enum VendorStatus {
  NEW
  UNDER_REVIEW
  APPROVED
  REJECTED
  BLACKLISTED
  NEEDS_RENEWAL // Added for auto-validation rule: auto "Rejected" or "Needs Renewal"
}

// --- New Document Type Enum (Required for robust Document Checklist) ---
enum VendorDocumentType {
  COMMERCIAL_REGISTRATION // CR
  ZAKAT_CERTIFICATE
  ISO_CERTIFICATE
  SASO_SABER_CERTIFICATE
  HSE_PLAN
  WARRANTY_CERTIFICATE
  QUALITY_PLAN
  ORGANIZATION_CHART
  TECHNICAL_FILE
  FINANCIAL_FILE
  VAT_CERTIFICATE
  GOSI_CERTIFICATE
  BANK_LETTER
  INSURANCE_CERTIFICATE
  INDUSTRY_LICENSE
  VENDOR_CODE_OF_CONDUCT
  COMPANY_PROFILE
}

// --- The Main Vendor Model (Consolidated and Enhanced) ---
model Vendor {
  id                   Int           @id @default(autoincrement())
  vendorId             String?       @unique // A. Vendor ID (Auto-number)
  companyLegalName     String?       // A. Company Legal Name (Mandatory)
  code                 String?       @unique // Retaining old code field if needed
  
  // --- A. Company Information (Enhanced) ---
  vendorType           String        // A. Vendor Type (Keep)
  ownershipType        String?       // ADDED: e.g., Local, Foreign, JointVenture (JV)
  businessType         String?       // A. Business Type (Dropdown)
  licenseNumber        String?       // A. License Number (Mandatory)
  yearsInBusiness      Int?          // A. Years in Business (Mandatory)
  gosiEmployeeCount    Int?          // A. GOSI Employee Count (Mandatory)
  chamberClass         String?       // A. Chamber of Commerce Certificate (Keep)
  chamberRegion        String?       // A. Chamber of Commerce Region/City
  chamberExpiryDate    DateTime?     // ADDED: CoC Expiry Date
  vatNumber            String?       // ADDED: Quick reference VAT Number
  // mainCategory: String[] removed - replaced by VendorToCategory relation
  // csiSpecializationId removed - replaced by VendorToCategory relation
  productsAndServices  String[]      // A. Products & Services (Multi-select, Mandatory)
  crNumber             String?       @unique // C. Commercial Registration Number (Mandatory)
  
  // --- B. Contact Information (Existing fields are kept) ---
  contactPerson        String?       // B. Contact Person (Mandatory)
  contactPhone         String?       // B. Phone Number (Mandatory)
  contactEmail         String?       // B. Email Address (Mandatory)
  website              String?       // B. Company Website (Optional)
  addressStreet        String?       // B. Location: Street (Mandatory)
  addressCity          String?       // B. Location: City (Mandatory)
  addressRegion        String?       // B. Location: Region/State (Mandatory)
  addressCountry       String?       // B. Location: Country (Mandatory)
  primaryContactName   String?       // B. Primary Contact Name (Mandatory)
  primaryContactTitle  String?       // B. Primary Contact Title (Mandatory)
  technicalContactName String?       // B. Technical Contact Name
  technicalContactEmail String?      // B. Technical Contact Email
  financialContactName String?       // B. Financial Contact Name
  financialContactEmail String?      // B. Financial Contact Email

  // --- System/Review Fields (Enhanced) ---
  status               VendorStatus @default(NEW)
  kreStatus            String       @default("New")
  reviewNotes          String?      // Last review notes
  reviewStatus         String?      // Last review status (redundant with main status, but kept)
  
  vendorClass          String?      @default("D") // ADDED: Classification: A, B, C, D
  qualificationScore   Float?       @default(0)   // UPDATED: Renamed from 'score'
  isQualified          Boolean      @default(false) // ADDED: Simple flag for quick filtering

  assignedReviewerId   Int?         // ADDED: ID of the internal user assigned to review
  lastReviewedById     Int?         // ADDED: ID of the last internal user to review
  nextReviewDate       DateTime?    // ADDED: Next scheduled review date

  // --- Relations ---
  userId               Int          @unique
  user                 User         @relation(fields: [userId], references: [id])
  projectExperience    VendorProjectExperience[] // A. Project Experience Table
  documents            VendorDocument[]          // C. Document Checklist
  
  // Updated CSI/Category relationship
  categories           VendorToCategory[] @relation("VendorToCategory") // UPDATED RELATION NAME

  // Updated Reviewer relationships
  assignedReviewer     User?        @relation("AssignedReviewer", fields: [assignedReviewerId], references: [id])
  lastReviewedBy       User?        @relation("LastReviewedBy", fields: [lastReviewedById], references: [id])
  
  // ... (Other relations)
  defaultCsiMaterial   CSI_Material[] @relation("CSI_MaterialToVendor")
  priceEntries         PriceEntry[]
  submissions          RFQSubmission[]
  contracts            Contract[]
  
  // Audit fields
  createdAt            DateTime     @default(now())
  updatedAt            DateTime     @updatedAt
}

// --- Enhanced VendorDocument Model (The Document Checklist) ---
model VendorDocument {
Â  idÂ  Â  Â  Â  Â  Â  IntÂ  Â  Â  Â  Â  Â  Â  Â  @id @default(autoincrement())
Â  vendorIdÂ  Â  Â  Int
Â  docTypeÂ  Â  Â  Â VendorDocumentType // ENUM: COMMERCIAL_REGISTRATION, ZAKAT_CERTIFICATE, etc.
Â  urlÂ  Â  Â  Â  Â  Â StringÂ  Â  Â  Â  Â  Â  Â // File URL (Mandatory for checklist)
Â  fileNameÂ  Â  Â  StringÂ  Â  Â  Â  Â  Â  Â 
Â  expiryDateÂ  Â  DateTime?Â  Â  Â  Â  Â  // Expiry Date (Mandatory for some docs)
Â  documentNumber String?Â  Â  Â  Â  Â  Â // CR Number, VAT Number, GOSI Number, etc.
Â  vatNumberÂ  Â  Â  String?Â  Â  Â  Â  Â  Â // B. VAT Number
Â  gosiNumberÂ  Â  Â String?Â  Â  Â  Â  Â  Â // B. GOSI Number
Â  isoTypeÂ  Â  Â  Â  String?Â  Â  Â  Â  Â  Â // B. ISO Type (e.g., 9001, 14001)
Â  isValidÂ  Â  Â  Â BooleanÂ  Â  Â  Â  Â  Â  @default(true) // Set to false if expired
Â  uploadedAtÂ  Â  DateTimeÂ  Â  Â  Â  Â  Â @default(now())
Â Â 
Â  vendorÂ  Â  Â  Â  VendorÂ  Â  Â  Â  Â  Â  Â @relation(fields: [vendorId], references: [id])
}

model VendorProjectExperience {
  id               Int       @id @default(autoincrement())
  vendorId         Int
  projectName      String
  clientName       String
  contractValue    Float
  startDate        DateTime?
  endDate          DateTime?
  scopeDescription String?
  referenceContact String?
  completionFile   String? // URL
  vendor           Vendor    @relation(fields: [vendorId], references: [id])
}

// --- CSI / Category Master List (Renamed from VendorCategory) ---
model Category {
  id          Int      @id @default(autoincrement())
  name        String   @unique // e.g., "Architectural Finishes"
  csiCode     String?  @unique // e.g., "09" (CSI Division)
  description String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // Relation to the link table
  vendors     VendorToCategory[] 
}

// --- Intermediary Table for Many-to-Many relationship (Vendor <-> Category) ---
model VendorToCategory {
  id         Int      @id @default(autoincrement())
  vendorId   Int
  categoryId Int

  vendor     Vendor   @relation("VendorToCategory", fields: [vendorId], references: [id])
  category   Category @relation(fields: [categoryId], references: [id])

  @@unique([vendorId, categoryId]) // Prevents duplicate links
}

model CSI_Material {
  id              Int          @id @default(autoincrement())
  csiCode         String?
  name            String
  unit            String?
  defaultVendorId Int?
  defaultVendor   Vendor?      @relation("CSI_MaterialToVendor", fields: [defaultVendorId], references: [id])
  priceEntries    PriceEntry[]
}

model PriceEntry {
  id            Int          @id @default(autoincrement())
  materialId    Int
  vendorId      Int
  unitPrice     Float
  currency      String       @default("NGN")
  createdAt     DateTime     @default(now())
  effectiveDate DateTime     @default(now())
  expiryDate    DateTime?
  updatedAt     DateTime     @updatedAt
  material      CSI_Material @relation(fields: [materialId], references: [id])
  vendor        Vendor       @relation(fields: [vendorId], references: [id])
}

model RFQ {
  id                   Int             @id @default(autoincrement())
  rfqNumber            String          @unique
  projectName          String
  packageScope         String?
  itemDesc             String?
  csiCode              String?
  estimatedUnitPrice   Float?
  requiredDate         DateTime?
  targetSubmissionDate DateTime?
  currency             String          @default("SAR")
  createdById          Int
  status               RFQStatus       @default(DRAFT)
  createdAt            DateTime        @default(now())
  description          String?
  dueDate              DateTime?
  title                String
  updatedAt            DateTime        @updatedAt
  contracts            Contract[]      @relation("RFQContract")
  createdBy            User            @relation("UserRFQs", fields: [createdById], references: [id])
  submissions          RFQSubmission[]
  attachments          Document[]      @relation("rfqAttachments")
}

model RFQSubmission {
  id          Int          @id @default(autoincrement())
  rfqId       Int
  vendorId    Int
  submittedAt DateTime?    @default(now())
  totalValue  Float?
  currency    String       @default("SAR")
  docUrl      String?
  items       Json?
  status      String?
  totalAmount Float?
  evaluations Evaluation[]
  rfq         RFQ          @relation(fields: [rfqId], references: [id])
  vendor      Vendor       @relation(fields: [vendorId], references: [id])
}

model Evaluation {
  id              Int           @id @default(autoincrement())
  submissionId    Int
  evaluatorId     Int
  technicalScore  Float?
  financialScore  Float?
  experienceScore Float?
  responsiveness  Float?
  otherScore      Float?
  totalScore      Float?
  comments        String?
  createdAt       DateTime      @default(now())
  evaluator       User          @relation("UserEvaluations", fields: [evaluatorId], references: [id])
  submission      RFQSubmission @relation(fields: [submissionId], references: [id])
}

model Contract {
  id              Int              @id @default(autoincrement())
  contractNumber  String           @unique
  rfqId           Int?
  vendorId        Int
  contractValue   Float
  currency        String           @default("SAR")
  startDate       DateTime?
  endDate         DateTime?
  status          String?
  createdAt       DateTime         @default(now())
  rfq             RFQ?             @relation("RFQContract", fields: [rfqId], references: [id])
  vendor          Vendor           @relation(fields: [vendorId], references: [id])
  documents       Document[]       @relation("ContractDocuments")
  ipcs            IPC[]
  variationOrders VariationOrder[]
}

model VariationOrder {
  id          Int      @id @default(autoincrement())
  voRef       String   @unique
  contractId  Int
  description String?
  costImpact  Float?
  timeImpact  Int?
  status      String?
  createdAt   DateTime @default(now())
  contract    Contract @relation(fields: [contractId], references: [id])
}

model IPC {
  id              Int        @id @default(autoincrement())
  ipcNumber       String     @unique
  projectName     String?
  contractId      Int
  periodFrom      DateTime?
  periodTo        DateTime?
  currentValue    Float
  cumulativeValue Float?
  deductions      Float?
  netPayable      Float?
  status          IPCStatus  @default(SUBMITTED)
  submittedById   Int
  createdAt       DateTime   @default(now())
  attachments     Document[] @relation("IPCAttachments")
  contract        Contract   @relation(fields: [contractId], references: [id])
  submittedBy     User       @relation("UserIPCs", fields: [submittedById], references: [id])
}

// Enhanced Document Model with Version Control
model Document {
  id             Int       @id @default(autoincrement())
  fileName       String
  fileUrl        String
  url            String
  mimeType       String?
  size           Int?
  uploadedById   Int?
  uploadedAt     DateTime  @default(now())
  
  // Version Control Fields
  version        Int       @default(1)
  isCurrent      Boolean   @default(true)
  previousVersionId Int?
  previousVersion Document? @relation("DocumentVersions", fields: [previousVersionId], references: [id])
  nextVersions   Document[] @relation("DocumentVersions")
  
  // Digital Signature Fields
  requiresSignature Boolean @default(false)
  signatureStatus   SignatureStatus @default(NOT_REQUIRED)
  signedById      Int?
  signedBy        User?    @relation("SignedDocuments", fields: [signedById], references: [id])
  signedAt        DateTime?
  
  // Approval Workflow - FIXED: Use DRAFT instead of PENDING
  approvalStatus  DocumentApprovalStatus @default(DRAFT)
  approvalWorkflowId Int?
  approvalWorkflow DocumentApprovalWorkflow? @relation(fields: [approvalWorkflowId], references: [id])
  
  // Relations
  ipcId          Int?
  contractId     Int?
  contract       Contract? @relation("ContractDocuments", fields: [contractId], references: [id])
  ipc            IPC?      @relation("IPCAttachments", fields: [ipcId], references: [id])
  uploadedBy     User?     @relation("uploadedBy", fields: [uploadedById], references: [id])
  rfqAttachments RFQ[]     @relation("rfqAttachments")

  // Add this relation at the end:
  documentApprovals DocumentApproval[] @relation("DocumentApprovals")
  
  // Document metadata for search
  tags           String[]
  category       String?
  description    String?
  
  @@map("documents")
}

// Document Approval Workflow
model DocumentApprovalWorkflow {
  id          Int       @id @default(autoincrement())
  name        String
  description String?
  steps       DocumentApprovalStep[]
  documents   Document[]
  createdAt   DateTime  @default(now())
  isActive    Boolean   @default(true)
}

model DocumentApprovalStep {
  id          Int       @id @default(autoincrement())
  workflowId  Int
  sequence    Int
  roleId      Int
  role        Role      @relation(fields: [roleId], references: [id])
  isRequired  Boolean   @default(true)
  workflow    DocumentApprovalWorkflow @relation(fields: [workflowId], references: [id])

  // Add this relation:
  documentApprovals DocumentApproval[] @relation("DocumentApprovalSteps")
  
  @@unique([workflowId, sequence])
}

model DocumentApproval {
  id          Int       @id @default(autoincrement())
  documentId  Int
  stepId      Int
  approverId  Int
  status      ApprovalStatus @default(PENDING)
  comments    String?
  approvedAt  DateTime?
  createdAt   DateTime  @default(now())
  
  // Add the inverse relations with the same relation names:
  document    Document  @relation("DocumentApprovals", fields: [documentId], references: [id])
  step        DocumentApprovalStep @relation("DocumentApprovalSteps", fields: [stepId], references: [id])
  approver    User      @relation("DocumentApprovalApprover", fields: [approverId], references: [id])
  
  @@unique([documentId, stepId])
}

// Document Templates
model DocumentTemplate {
  id          Int       @id @default(autoincrement())
  name        String
  description String?
  category    String
  fileUrl     String?
  content     Json?     // For dynamic templates
  variables   Json?     // Template variables schema
  isActive    Boolean   @default(true)
  createdAt   DateTime  @default(now())
  createdById Int
  createdBy   User      @relation("DocumentTemplateCreator", fields: [createdById], references: [id])
}

model Approval {
  id         Int            @id @default(autoincrement())
  entityType String
  entityId   Int
  approverId Int
  sequence   Int
  status     ApprovalStatus @default(PENDING)
  comment    String?
  createdAt  DateTime       @default(now())
  actedAt    DateTime?
  approver   User           @relation(fields: [approverId], references: [id])
}

// Approval Workflow Templates
model ApprovalWorkflowTemplate {
  id          String   @id @default(uuid())
  name        String
  description String?
  category    String   // "VENDOR_QUALIFICATION", "CONTRACT", "PO", "IPC"
  steps       ApprovalWorkflowStep[]
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  approvalInstances ApprovalInstance[] @relation("ApprovalWorkflowInstances") // ðŸ‘ˆ ADD THIS

  @@map("approval_workflow_templates")
}

model ApprovalWorkflowStep {
  id          String   @id @default(uuid())
  templateId  String
  sequence    Int
  roleId      Int
  role        Role     @relation(fields: [roleId], references: [id])
  isRequired  Boolean  @default(true)
  minAmount   Float?   // Minimum amount for this step to trigger
  maxAmount   Float?   // Maximum amount for this step
  conditions  Json?    // Additional conditions for routing
  
  template    ApprovalWorkflowTemplate @relation(fields: [templateId], references: [id])

  // Add this relation:
  approvalActions ApprovalAction[] @relation("ApprovalWorkflowStepActions") // ðŸ‘ˆ ADD THIS
  
  @@unique([templateId, sequence])
  @@map("approval_workflow_steps")
}

// Active Approval Instances
model ApprovalInstance {
  id          String   @id @default(uuid())
  entityType  String   // "VENDOR", "CONTRACT", "PO", "IPC"
  entityId    Int
  workflowId  String
  status      ApprovalInstanceStatus @default(PENDING)
  currentStep Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  workflow    ApprovalWorkflowTemplate @relation("ApprovalWorkflowInstances", fields: [workflowId], references: [id]) // ðŸ‘ˆ ADD RELATION NAME
  approvals   ApprovalAction[]
  
  @@unique([entityType, entityId])
  @@map("approval_instances")
}

model ApprovalAction {
  id          String         @id @default(uuid())
  instanceId  String
  stepId      String
  approverId  Int
  status      ApprovalStatus @default(PENDING)
  comments    String?
  signedAt    DateTime?
  signatureData Json?        // Digital signature data
  metadata    Json?          // Additional approval data
  createdAt   DateTime       @default(now())
  updatedAt   DateTime       @updatedAt

  instance    ApprovalInstance @relation(fields: [instanceId], references: [id])
  step        ApprovalWorkflowStep @relation("ApprovalWorkflowStepActions", fields: [stepId], references: [id]) // ðŸ‘ˆ ADD RELATION NAME
  approver    User           @relation("ApprovalActionApprover", fields: [approverId], references: [id]) // ðŸ‘ˆ ADD RELATION NAME
  
  @@unique([instanceId, stepId])
  @@map("approval_actions")
}

model AuditLog {
  id        Int      @id @default(autoincrement())
  userId    Int?
  action    String
  entity    String?
  entityId  Int?
  data      Json?
  createdAt DateTime @default(now())
  user      User?    @relation("UserAuditLogs", fields: [userId], references: [id])
}


// In your Notification model, update to:
model Notification {
  id          Int       @id @default(autoincrement())
  userId      Int
  title       String
  body        String?
  type        String    @default("INFO") // INFO, WARNING, REMINDER, ERROR
  priority    String    @default("MEDIUM") // LOW, MEDIUM, HIGH
  read        Boolean   @default(false)
  readAt      DateTime?
  actionUrl   String?   // URL for the notification action
  metadata    Json?     // Additional data for the notification
  createdAt   DateTime  @default(now())
  
  // Fix: Add relation name to match User model
  user        User      @relation("UserNotifications", fields: [userId], references: [id])

  @@map("notifications")
}


model Report {
  id              Int              @id @default(autoincrement())
  name            String
  description     String?
  category        String
  dataSource      String
  createdById     Int
  isPublic        Boolean          @default(false)
  isScheduled     Boolean          @default(false)
  scheduleFrequency String?
  nextSchedule    DateTime?
  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt
  
  createdBy       User             @relation("UserCreatedReports", fields: [createdById], references: [id])
  filters         ReportFilter[]
  columns         ReportColumn[]
  executions      ReportExecution[]
  favorites       UserReportFavorite[]
}

model ReportFilter {
  id        Int    @id @default(autoincrement()) // Changed from String
  reportId  Int                                  // Changed from String
  field     String  // Match backend field name
  operator  String
  value     String
  sortOrder Int    @default(0)
  
  report    Report @relation(fields: [reportId], references: [id], onDelete: Cascade)
}

model ReportColumn {
  id              Int    @id @default(autoincrement()) // Changed from String
  reportId        Int                                  // Changed from String
  fieldName       String
  columnLabel     String
  dataType        String  // Simplified to match backend
  aggregationType String  @default("NONE") // Simplified
  sortOrder       Int     @default(0)
  
  report          Report  @relation(fields: [reportId], references: [id], onDelete: Cascade)
}

model ReportExecution {
  id            Int      @id @default(autoincrement())
  reportId      Int                                    
  executedById  Int
  status        String
  parameters    Json?
  recordCount   Int?
  executionTime Int?
  errorMessage  String?
  filePath      String?
  executedAt    DateTime @default(now())
  
  report       Report @relation(fields: [reportId], references: [id], onDelete: Cascade)
  executedBy   User   @relation("UserReportExecutions", fields: [executedById], references: [id]) // ADDED relation name
}

model UserReportFavorite {
  id       Int @id @default(autoincrement())
  userId   Int
  reportId Int
  
  user   User   @relation("UserReportFavorites", fields: [userId], references: [id]) // ADDED relation name
  report Report @relation(fields: [reportId], references: [id], onDelete: Cascade)

  @@unique([userId, reportId])
}

// Report Templates (Pre-built reports)
model ReportTemplate {
  id          String         @id @default(uuid())
  name        String
  description String?
  category    ReportCategory
  dataSource  String
  template    Json           // Complete report definition
  isActive    Boolean        @default(true)
  createdAt   DateTime       @default(now())
  
  @@map("report_templates")
}

model Task {
  id          Int       @id @default(autoincrement())
  title       String
  description String?
  taskType    TaskType
  assignedTo  Int       // User ID
  assignedById Int      // User ID who assigned the task
  dueDate     DateTime
  priority    Priority  @default(MEDIUM)
  status      TaskStatus @default(NOT_STARTED)
  remarks     String?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  
  // Relations
  assignedUser   User   @relation("AssignedTasks", fields: [assignedTo], references: [id])
  assignedByUser User   @relation("CreatedTasks", fields: [assignedById], references: [id])
}

enum TaskType {
  VENDOR_REVIEW
  RFQ_EVALUATION
  CONTRACT_REVIEW
  IPC_PROCESSING
  DOCUMENT_VERIFICATION
  PROJECT_FOLLOWUP
  GENERAL
}

enum Priority {
  LOW
  MEDIUM
  HIGH
  URGENT
}

enum TaskStatus {
  NOT_STARTED
  IN_PROGRESS
  COMPLETED
  OVERDUE
  CANCELLED
}

// Report Categories Enum
enum ReportCategory {
  FINANCIAL
  VENDOR
  CONTRACT
  PROJECT
  CUSTOM
}

// Report Schedule Frequency Enum
enum ReportFrequency {
  DAILY
  WEEKLY
  MONTHLY
  QUARTERLY
}

// Filter Types Enum
enum FilterType {
  DATE
  SELECT
  MULTISELECT
  NUMBER
  TEXT
  BOOLEAN
}

// Data Types Enum
enum DataType {
  STRING
  NUMBER
  DATE
  CURRENCY
  PERCENTAGE
  BOOLEAN
}

// Aggregation Types Enum
enum AggregationType {
  SUM
  AVERAGE
  COUNT
  MIN
  MAX
  NONE
}

// Report Status Enum
enum ReportStatus {
  DRAFT
  ACTIVE
  ARCHIVED
}

// Report Execution Status Enum
enum ExecutionStatus {
  RUNNING
  COMPLETED
  FAILED
  CANCELLED
}

enum UserStatus {
  PENDING
  ACTIVE
}

enum RoleName {
  ADMIN
  PROCUREMENT_MANAGER
  PROCUREMENT_ENGINEER
  COST_MANAGER
  PROJECT_MANAGER
  TECHNICAL_OFFICE
  DATA_CONTROLLER
  VENDOR_USER
}

enum RFQStatus {
  DRAFT
  ISSUED
  OPEN
  CLOSED
  AWARDED
  CANCELED
}

enum IPCStatus {
  SUBMITTED
  PROCUREMENT_REVIEW
  TECHNICAL_APPROVED
  FINANCE_REVIEW
  APPROVED
  PAID
  REJECTED
}

// Enums for new functionality
enum SignatureStatus {
  NOT_REQUIRED
  PENDING_SIGNATURE
  SIGNED
  REJECTED
  EXPIRED
}

enum DocumentApprovalStatus {
  DRAFT
  PENDING_APPROVAL
  IN_REVIEW
  APPROVED
  REJECTED
  CHANGES_REQUESTED
}

// Enums for approval system
enum ApprovalInstanceStatus {
  PENDING
  IN_PROGRESS
  APPROVED
  REJECTED
  CANCELLED
  ESCALATED
}

enum ApprovalStatus {
  PENDING
  APPROVED
  REJECTED
  RETURNED
  ESCALATED
}